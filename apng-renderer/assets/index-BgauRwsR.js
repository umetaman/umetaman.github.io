(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=e(s);fetch(s.href,c)}})();const m=[137,80,78,71,13,10,26,10],L=r=>r.slice(0,m.length).every((e,n)=>e===m[n]),P=r=>{if(L(r)==!1)throw new Error("This is not PNG");const t=new DataView(r.buffer),e=[];let n=m.length;for(;n<r.length;){const s=t.getUint32(n);n+=4;const c=t.buffer.slice(n,n+4),i=String.fromCharCode(...new Uint8Array(c));n+=4;const o=r.slice(n,n+s);n+=s;const a=r.slice(n,n+4);switch(n+=4,i){case"IHDR":const u=N(o);e.push({length:s,type:i,content:u,crc:a});break;case"IDAT":const g={data:o};e.push({length:s,type:i,content:g,crc:a});break;case"acTL":const f=V(o);e.push({length:s,type:i,content:f,crc:a});break;case"fcTL":const A=O(o);e.push({length:s,type:i,content:A,crc:a});break;case"fdAT":const E=C(o);e.push({length:s,type:i,content:E,crc:a});break;default:e.push({length:s,type:i,content:o,crc:a})}}return e},N=r=>{const t=new DataView(r.buffer),e=t.getUint32(0),n=t.getUint32(4),s=t.getUint8(8),c=t.getUint8(9),i=t.getUint8(10),o=t.getUint8(11),a=t.getUint8(12);return{width:e,height:n,bitDepth:s,colorType:c,compressionMethod:i,filterMethod:o,interlaceMethod:a}},V=r=>{const t=new DataView(r.buffer),e=t.getUint32(0),n=t.getUint32(4);return{numFrames:e,numPlays:n}},O=r=>{const t=new DataView(r.buffer),e=t.getUint32(0),n=t.getUint32(4),s=t.getUint32(8),c=t.getUint32(12),i=t.getUint32(16),o=t.getUint16(20),a=t.getUint16(22),u=t.getUint8(24),g=t.getUint8(25);return{sequenceNumber:e,width:n,height:s,xOffset:c,yOffset:i,delayNum:o,delayDen:a,disposeOp:u,blendOp:g}},C=r=>({sequenceNumber:new DataView(r.buffer).getUint32(0),data:r.slice(4)}),R=3988292384,I=new Uint32Array(256);for(let r=0;r<256;r++){let t=r;for(let e=0;e<8;e++)(t&1)===1?t=t>>>1^R:t=t>>>1;I[r]=t}const w=r=>{let t=4294967295;for(let e=0;e<r.length;e++)t=t>>>8^I[(t^r[e])&255];return t=t^4294967295,t},p=4,D=13,k=(r,t)=>{const e={...r};return e.width=t.width,e.height=t.height,e},F=r=>{r.set(m,0)},y=r=>new Uint8Array(r.split("").map(t=>t.charCodeAt(0))),v=(r,t,e)=>{const n=new DataView(r.buffer);n.setUint32(e,D),e+=4,r.set(y("IHDR"),e),e+=4,n.setUint32(e,t.width),e+=4,n.setUint32(e,t.height),e+=4,n.setUint8(e,t.bitDepth),e+=1,n.setUint8(e,t.colorType),e+=1,n.setUint8(e,t.compressionMethod),e+=1,n.setUint8(e,t.filterMethod),e+=1,n.setUint8(e,t.interlaceMethod),e+=1;const s=w(r.slice(e-D-p,e));n.setUint32(e,s)},M=(r,t,e)=>{const n=new DataView(r.buffer);n.setUint32(e,t.length),e+=4,r.set(y("IDAT"),e),e+=4,r.set(t,e),e+=t.length;const s=w(r.slice(e-t.length-p,e));n.setUint32(e,s)},H=(r,t)=>{const e=new DataView(r.buffer);e.setUint32(t,0),t+=4,r.set(y("IEND"),t),t+=4;const n=w(r.slice(t-p,t));e.setUint32(t,n)},S=r=>{const t=45+r.data.length+12;return new Uint8Array(t)};class x{chunks;numFrames=0;numPlays=0;ihdr;frames=[];get playCount(){return this.numPlays}get frameCount(){return this.numFrames}constructor(t){if(this.chunks=P(t),!this.chunks)throw new Error("Failed to read chunks");if(this.chunks[0].type!=="IHDR")throw new Error("IHDR not found");this.ihdr=this.chunks[0].content;const e=this.chunks.find(c=>c.type==="acTL");if(!e)throw new Error("acTL not found");const n=e.content;this.numFrames=n.numFrames,this.numPlays=n.numPlays;let s={control:void 0,content:void 0};for(let c=0;this.chunks[c].type!=="IEND";c++){const i=this.chunks[c];i.type=="fcTL"&&(s.control=i.content),i.type=="fdAT"&&(s.content=i.content),i.type=="IDAT"&&(s.content=i.content),s.control&&s.content&&(this.frames.push(s),s={})}console.assert(this.frames.length==this.numFrames)}createCanvasElement(){const t=document.createElement("canvas");return t.width=this.ihdr.width,t.height=this.ihdr.height,t}renderFrame(t,e){const n=this.frames[t],s=n.image;if(!s)throw new Error("Image not loaded");const c=e.getContext("2d");if(!c)throw new Error("Failed to get 2d context");c.clearRect(0,0,e.width,e.height),c.drawImage(s,n.control.xOffset,n.control.yOffset)}async loadAsync(){const t=[];for(let e=0;e<this.frames.length;e++){const n=this.frames[e];if(n.content){const s=this.buildPNG(n.control,n.content),c=new Blob([s],{type:"image/png"}),i=URL.createObjectURL(c),o=new Image;o.src=i;const a=new Promise(u=>{o.onload=()=>{n.image=o,u()}});t.push(a)}}await Promise.all(t)}buildPNG(t,e){const n=S(e),s=k(this.ihdr,t);let c=0;return F(n),c+=8,v(n,s,c),c+=25,M(n,e.data,c),c+=8+e.data.length+4,H(n,c),n}}const T="/assets/apng-Cy0aw9uM.png",G=await fetch(T),B=new Uint8Array(await G.arrayBuffer()),d=new x(B);await d.loadAsync();const l=document.getElementById("app"),U=d.createCanvasElement();l==null||l.appendChild(U);const h=document.createElement("input");h.type="range";h.min="0";h.max=(d.numFrames-1).toString();h.value="0";l==null||l.appendChild(h);h.addEventListener("input",()=>{d.renderFrame(parseInt(h.value),U)});d.renderFrame(0,U);const b=document.createElement("img");b.src=T;l==null||l.appendChild(b);
